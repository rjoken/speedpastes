<div class="max-w-3xl mx-auto space-y-6">
    <div class="border border-[var(--border)] bg-[var(--surface)] shadow-sm">
        <div class="border-b border-[var(--border-muted)] bg-gradient-to-b from-[var(--surface2)] to-[var(--surface)] px-4 py-3">
            <div class="text-lg font-black">Settings</div>
        </div>
        <div class="p-4 space-y-4">
            <details class="border border-[var(--border-muted)] bg-[var(--surface2)] p-3">
                <summary class="cursor-pointer font-bold">Edit profile</summary>
                <div class="mt-3 space-y-10">
                <div class="flex flex-col md:flex-row items-start gap-6">
                    <div class="flex flex-col items-center">
                        <%= render "shared/avatar", user: current_user, size: 128 %>
                        <% if current_user.avatar.attached? %>
                            <div class="mt-2">
                                <%= button_to "Remove avatar", avatar_settings_path, method: :delete, data: { turbo_confirm: "Remove your avatar?" }, form_class: "inline", class: button_class(variant: :default, size: :sm) %>
                            </div>
                        <% end %>
                    </div>
                    <div class="flex-1">
                        <%= form_with model: current_user, url: settings_path, method: :patch, multipart: true, data: { turbo: false }, class: "space-y-6" do |f| %>
                            <div>
                                <%= f.label :avatar, "Upload avatar", class: "block text-sm font-semibold" %>
                                <%= f.file_field :avatar, accept: "image/*", class: "mt-1 block w-full text-sm cursor-pointer border border-[var(--border)] bg-[var(--surface)] hover:bg-[var(--surface2)] px-3 py-2" %>
                                <div class="text-xs text-[var(--muted)] mt-1">PNG/JPG/WEBP/GIF</div>
                            </div>
                            <div class="flex flex-col md:flex-row items-start gap-6">
                                <div class="flex-1">
                                    <%= f.label :bio, "Bio", class: "block text-sm font-semibold" %>
                                    <%= f.text_area :bio, rows: 3, class: "mt-1 w-full border border-[var(--border)] px-3 py-2" %>
                                </div>
                                <div class="flex-1">
                                    <%= f.label :link, "External link", class: "block text-sm font-semibold" %>
                                    <%= f.url_field :link, class: "mt-1 w-full border border-[var(--border)] px-3 py-2" %>
                                </div>
                            </div>

                            <div class="flex justify-end mt-4">
                                <%= f.submit "Update profile", class: button_class(variant: :default, size: :md) %>
                            </div>
                        <% end %>
                    </div>
                <div>
            </details>

            <details class="border border-[var(--border-muted)] bg-[var(--surface2)] p-3">
                <summary class="cursor-pointer font-bold">Change your email address</summary>
                <div class="mt-3">
                    <%= form_with url: email_settings_path, method: :patch do %>
                        <div>
                            <%= label_tag :current_email, "Current email address", class: "block text-sm font-semibold" %>
                            <%= email_field_tag :current_email, nil, autocomplete: "email", class: "mt-1 w-full border border-[var(--border)] px-3 py-2" %>
                        </div>
                        <div class="mt-4">
                            <%= label_tag :new_email, "New email address", class: "block text-sm font-semibold" %>
                            <%= email_field_tag :new_email, nil, autocomplete: "email", class: "mt-1 w-full border border-[var(--border)] px-3 py-2" %>
                        </div>
                        <div class="mt-4">
                            <%= label_tag :current_password, "Current password", class: "block text-sm font-semibold" %>
                            <%= password_field_tag :current_password, nil, autocomplete: "current-password", class: "mt-1 w-full border border-[var(--border)] px-3 py-2" %>
                        </div>
                        <div class="flex justify-end mt-4">
                            <%= submit_tag "Update email address", class: button_class(variant: :default, size: :md) %>
                        </div>
                    <% end %>
                </div>
            </details>

            <details class="border border-[var(--border-muted)] bg-[var(--surface2)] p-3">
                <summary class="cursor-pointer font-bold">Change your password</summary>
                <div class="mt-3">
                    <%= form_with url: password_settings_path, method: :patch do %>
                        <div class="mt-4">
                            <%= label_tag :current_password, "Current password", class: "block text-sm font-semibold" %>
                            <%= password_field_tag :password, nil, autocomplete: "current-password", class: "mt-1 w-full border border-[var(--border)] px-3 py-2" %>
                        </div>
                        <div class="mt-4">
                            <%= label_tag :new_password, "New password", class: "block text-sm font-semibold" %>
                            <%= password_field_tag :new_password, nil, autocomplete: "new-password", class: "mt-1 w-full border border-[var(--border)] px-3 py-2" %>
                        </div>
                        <div class="mt-4">
                            <%= label_tag :new_password_confirmation, "Confirm new password", class: "block text-sm font-semibold" %>
                            <%= password_field_tag :new_password_confirmation, nil, autocomplete: "new-password", class: "mt-1 w-full border border-[var(--border)] px-3 py-2" %>
                        </div>
                        <div class="flex justify-end mt-4">
                            <%= submit_tag "Update password", class: button_class(variant: :default, size: :md) %>
                        </div>
                    <% end %>
                </div>
            </details>

            <details class="border border-[var(--border-muted)] bg-[var(--surface2)] p-3">
                <summary class="cursor-pointer font-bold">Change your username</summary>
                <div class="mt-3">
                    <%= form_with url: username_settings_path, method: :patch do %>
                        <div class="mt-4">
                            <%= label_tag :current_password, "Current password", class: "block text-sm font-semibold" %>
                            <%= password_field_tag :current_password, nil, autocomplete: "current-password", class: "mt-1 w-full border border-[var(--border)] px-3 py-2" %>
                        </div>
                        <div class="mt-4">
                            <%= label_tag :new_username, "New username", class: "block text-sm font-semibold" %>
                            <%= text_field_tag :new_username, nil, autocomplete: "username", class: "mt-1 w-full border border-[var(--border)] px-3 py-2" %>
                        </div>
                        <div class="flex justify-end mt-4">
                            <%= submit_tag "Update username", class: button_class(variant: :default, size: :md) %>
                        </div>
                    <% end %>
                </div>
            </details>

            <details class="border border-[var(--border-muted)] bg-[var(--surface2)] p-3">
                <summary class="cursor-pointer font-bold">Import pastes from Pastebin</summary>
                <div class="text-sm text-[var(--muted)] mt-1">Import your pastes from Pastebin.com into your speedpastes account.</div>
                <div class="text-sm text-[var(--text)] mt-1">You will first need to go to <a href="https://pastebin.com/user/backup" class="text-[var(--link)] underline">https://pastebin.com/user/backup</a> whilst logged in and download your zip file of pastes. Please be aware that this contains all of your pastes, including private and unlisted ones, and the visibility of each paste is not differentiated. You can choose to import all of your pastes here as unlisted. Otherwise, you can rename the files inside of the zip before importing into speedpastes by adding a "!" to the beginning of the filename, and speedpastes will import these as unlisted.</div>

                <div class="mt-3">
                    <%= form_with url: import_pastebin_settings_path, method: :post, multipart: true, data: {turbo: false}, class: "space-y-3" do %>
                        <div>
                            <%= label_tag :zip, "Pastebin zip file", class: "block text-sm font-semibold" %>
                            <%= file_field_tag :zip, accept: ".zip", class: "mt-1 block w-full text-sm cursor-pointer bg-[var(--surface)] border border-[var(--border)] hover:bg-[var(--surface2)] px-3 py-2" %>
                        </div>

                        <div class="flex items-center gap-2">
                            <%= label_tag :default_visibility, "Default visibility", class: "text-sm font-semibold" %>
                            <%= select_tag :default_visibility, options_for_select(Paste.visibilities.keys.map { |k| [k, k] }, "open"),
                                class: "border border-[var(--button-border)] bg-[var(--button-bg)] px-2 py-1 text-sm font-bold shadow-sm hover:bg-[var(--button-bg-hover)]" %>
                            <span class="text-xs text-[var(--muted)]">Used when filenames don't start with "!"</span>
                        </div>

                        <div class="flex justify-end mt-4">
                            <%= submit_tag "Import pastes", class: button_class(variant: :default, size: :md) %>
                        </div>
                    <% end %>
                </div>
            </details>

            <details class="border border-[var(--border-muted)] bg-[var(--surface2)] p-3">
                <summary class="cursor-pointer font-bold">Request your data</summary>
                <div class="text-sm text-[var(--muted)] mt-1">Download a ZIP file containing all of your pastes and account information, in accordance with data protection regulations.</div>

                <div class="mt-3">
                    <%= form_with url: data_export_settings_path, method: :post, data: { turbo: false } do %>
                        <%= submit_tag "Download my data", class: button_class(variant: :default, size: :md) %>
                    <% end %>
                </div>
            </details>

            <details class="border border-[var(--border-danger)] bg-[var(--bg-danger)] p-3">
                <summary class="cursor-pointer font-bold text-[var(--text-danger)]">Delete your account</summary>
                <div class="mt-3 text-sm text-[var(--text-danger)]">This action is irreversible. All of your pastes and account information will be permanently deleted.</div>
                <%= form_with url: account_settings_path, method: :delete, data: { turbo: false }, class: "mt-3 space-y-3" do %>
                    <div>
                        <%= label_tag :password, "Confirm your password to delete your account.", class: "block text-sm font-semibold text-[var(--text-danger)]" %>
                        <%= password_field_tag :password, nil, autocomplete: "current-password", class: "mt-1 w-full border border-[var(--border-danger)] px-3 py-2" %>
                    </div>

                    <div class="flex items-center justify-between">
                        <div class="text-xs text-[var(--text-danger)]">You will be logged out immediately.</div>
                        <%= submit_tag "Delete my account", class: button_class(variant: :danger, size: :md) %>
                    </div>
                <% end %>
            </details>
        </div>
    </div>
</div>
        